{
  "hash": "e94f82a37ce6e595fd5ef2c47d9197e9",
  "result": {
    "markdown": "---\ntitle: \"<br><br>Stratification and samplingÔ∏è of population centers in Loreto, Peru üé≤‚ú®\"\nnumber-sections: true\nformat: \n html:\n   code-fold: true\n   code-summary: \"Show code\"\n   toc: true\neditor: visual\ncss: css/methodology.css\nbibliography: references/references.bib\n---\n\n::: {.cell}\n<style type=\"text/css\">\n.panel-tabset .nav-item {\n  font-size: 10px;\n  font-style: italic\n}\n</style>\n:::\n\n\n## Introduction {#intro}\n\nThis document describes the methodology carried out for the stratification and selection of population centers in Loreto for drone surveillance. This activity is part of the the *Harmonize project: Harmonisation of spatio-temporal multi-scale data for health in climate change hotspots in the Peruvian Amazon* (SIDISI 209821), in collaboration with the Barcelona Supercomputing Center.\n\nThe Harmonize project has the following objectives:\n\n1)  Geo-location of cases collected by passive surveillance from the Peruvian Ministry of Health (MINSA) through the Center for Disease Control and Prevention (CDC-Peru) in the study area using GPS devices.\n\n2)  Identify potential mosquito breeding sites based on new longitudinal ground survey data and using drone surveillance.\n\n3)  Collect data from weather stations, satellite imagery, ambient acoustic sounds and air pollution to calibrate and reduce the spatial resolution of Earth observation data sets.\n\n4)  Determine the impact of the use of these new technologies on infectious disease reduction interventions carried out by the Direcci√≥n Regional de Salud (DIRESA) of Loreto.\n\nThe methodology described here corresponds to the second objective above. Since we cannot map the whole study area of Loreto, our approach was to characterize the population centers in Loreto according to the incidence of relevant diseases in the area (Malaria, Dengue and Leptospirosis) and meteorological, environmental and human intervention variables (temperature, precipitation, soil moisture, deforestation, etc.) and then use this variables to create sampling strata using clustering techniques. Finally, we randomly sampled a number of the population centers from each stratum proportional to the stratum size.\n\n## Dataset {#dataset}\n\nFor each population center, we gathered records on the following fields:\n\n-   UBIGEO, which is the official identification code of the population centers used by the Instituto Nacional de Estad√≠stica e Inform√°tica (INEI).\n-   Official name .\n-   Latitude and longitud.\n-   Cumulative incidence of malaria, dengue and leptospirosis from epidemiological week 1 to 39 of 2022.\n-   Mean and difference of the annual mean values of the years 2010 and 2021 of the following variables:\n    -   Precipitation accumulation (mm),\n    -   Runoff (mm),\n    -   Soil moisture (mm),\n    -   Maximum temperature (¬∞C),\n    -   Minimum temperature (¬∞C),\n    -   Total evapotranspiration (kg/m^2^),\n    -   Specific humidity (kg/kg),\n    -   Deforestation area (km^2^).\n-   Mean and difference of the annual values of the years 2010 and 2020 of the following variables:\n    -   Population density from WorldPop and\n    -   Human settlement data from the Global Human Settlement Layer (GHSL).\n-   Mean and difference of the annual mean values from years 2014 and 2021 of the nighttime data from the Visible Infrared Imaging Radiometer Suite (VIIRS).\n\nWe can take a look at the data in the following table:\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary packages\nlibrary(dplyr, quietly = TRUE)\nlibrary(factoextra, quietly = TRUE)\nlibrary(cluster, quietly = TRUE)\nlibrary(leaflet, quietly = TRUE)\n\n# Read dataset\ndataset = readr::read_csv(\"data/processed/sample-10.csv\", col_types = \"ccd\")\n\n# Display dataset\ndataset %>% \n  mutate(across(where(is.numeric), ~ round(.x, 2))) %>% \n  DT::datatable(\n    options = list(display = \"compact\", pageLength = 5, scrollX = TRUE)\n  )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-2cda1de21a2824f362be\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-2cda1de21a2824f362be\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\"],[\"1601130018\",\"1601130024\",\"1601130020\",\"1601130065\",\"1601130026\",\"1601130029\",\"1601130039\",\"1601130088\",\"1601130079\",\"1603010099\",\"1601130078\"],[\"ZUNGARO COCHA\",\"VARILLAL\",\"5 DE JUNIO\",\"SAN CARLOS\",\"SAN JOSE\",\"24 DE JUNIO\",\"EX PETROLEROS II ZONA\",\"SANTA CATALINA\",\"HUAMBE\",\"1 DE FEBRERO\",\"NUEVO TRIUNFO\"],[-3.83,-3.89,-4,-3.96,-3.93,-4.02,-4.06,-4.12,-4.16,-4.36,-4.13],[-73.35,-73.35,-73.39,-73.35,-73.39,-73.42,-73.47,-73.48,-73.49,-73.55,-73.5],[0.03,0.15,0,0.01,0.02,0,0,0,0,0,0.12],[0.01,0.01,0,0.01,0.02,0,0,0,0,0,0],[0,0.01,0,0.03,0.01,0,0,0,0,0,0],[2360.4,2355.06,2331.05,2338.9,2351.33,2327.43,2307.92,2284.65,2269.98,2199.42,2281.76],[1378.27,1373.22,1349.94,1359.1,1372.78,1345.1,1327.83,1303.92,1289.61,1214.8,1301.08],[446.72,457.05,471.35,468.28,461.1,470.97,471.7,477.17,480.8,496.66,477.21],[378.38,377.12,377.9,377.11,377.13,378.08,378.67,379.42,379.89,381.35,379.45],[262.4,262.25,263.28,263.08,262.04,263.06,263.07,263.54,263.79,263.96,263.36],[30.26,31.77,33.48,32.89,31.91,33.29,32.91,33.01,33.08,32.25,32.93],[0.22,0.22,0.22,0.22,0.22,0.22,0.22,0.22,0.22,0.22,0.22],[1.67,1.52,0.43,0.51,0.49,0.43,0.34,0.27,0.26,0.28,0.23],[1,1,0.75,0.63,0.63,0.65,0.64,0.85,0.8,0.37,0.81],[139.76,45.28,9.63,7.38,14.43,10.17,9.78,5.59,1.4,1.08,1.24],[2.46,1.12,0.48,0.54,0.67,0.5,0.62,0.56,0.49,0.36,0.53],[103251,27119.5,0,301,184.5,0,4.5,0,0,91.5,0],[1293.66,1295.67,1286.88,1292.04,1299.57,1281.95,1260.71,1232.79,1214.14,1138.05,1229.37],[1196.94,1200.29,1194.17,1198.57,1205.05,1188.69,1168,1140.37,1123.46,1059.55,1136.86],[65.99,66.14,64.85,65.34,64.59,63.8,60.97,60.21,59.57,42.05,59.72],[-0.33,-0.4,-0.63,-0.78,-0.47,-0.53,-0.54,-0.55,-0.52,-0.65,-0.54],[-0.33,-0.4,-0.63,-0.78,-0.47,-0.53,-0.54,-0.55,-0.52,-0.65,-0.54],[-0.24,-0.03,0.94,-0.29,-0.05,0.38,-0.72,-0.93,-0.6,-0.22,-1.15],[0,0,0,0,0,0,0,0,0,0,0],[0.98,0.75,0.16,0.09,0.18,0.19,0.17,0.08,0.06,0.02,0.04],[-0.62,0.64,0.13,0.15,0.34,-0.21,-0.62,-0.15,-0.14,-0.15,0.07],[33.36,14.86,7.35,5.2,11.72,4.9,3.62,2.85,0.83,0.52,1.24],[1.08,0.8,0.35,0.41,0.37,0.35,0.51,0.49,0.42,0.17,0.47],[0.02,0.07,0,0.01,0.01,0,-0.11,0,0,-0.01,0],[1,1,1,1,1,2,2,2,2,2,2],[1,1,1,1,1,2,2,3,3,3,3],[1,1,2,2,2,3,3,4,4,4,4],[6.87,4.58,0.18,0.11,1.93,-0.06,-0.94,-1.88,-2.57,-6.47,-2.06],[1,1,1,1,1,1,2,2,2,2,2],[1,1,2,2,1,2,2,2,3,3,3],[1,1,2,2,2,2,3,3,4,4,3]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>ubigeo<\\/th>\\n      <th>population_center<\\/th>\\n      <th>lat<\\/th>\\n      <th>lon<\\/th>\\n      <th>malaria<\\/th>\\n      <th>dengue<\\/th>\\n      <th>lepto<\\/th>\\n      <th>pr_mean<\\/th>\\n      <th>ro_mean<\\/th>\\n      <th>soil_mean<\\/th>\\n      <th>tmmx_mean<\\/th>\\n      <th>tmmn_mean<\\/th>\\n      <th>etp_mean<\\/th>\\n      <th>humidity_mean<\\/th>\\n      <th>pop_mean<\\/th>\\n      <th>def_mean<\\/th>\\n      <th>ghs_mean<\\/th>\\n      <th>ln_mean<\\/th>\\n      <th>malaria_mean<\\/th>\\n      <th>pr_diff<\\/th>\\n      <th>ro_diff<\\/th>\\n      <th>soil_diff<\\/th>\\n      <th>tmmx_diff<\\/th>\\n      <th>tmmn_diff<\\/th>\\n      <th>etp_diff<\\/th>\\n      <th>humidity_diff<\\/th>\\n      <th>pop_diff<\\/th>\\n      <th>def_diff<\\/th>\\n      <th>ghs_diff<\\/th>\\n      <th>ln_diff<\\/th>\\n      <th>malaria_diff<\\/th>\\n      <th>hc_group_2<\\/th>\\n      <th>hc_group_3<\\/th>\\n      <th>hc_group_4<\\/th>\\n      <th>pca_score<\\/th>\\n      <th>pca_group_2<\\/th>\\n      <th>pca_group_3<\\/th>\\n      <th>pca_group_4<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"display\":\"compact\",\"pageLength\":5,\"scrollX\":true,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[5,10,25,50,100]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## Stratification\n\nThe stratification of the population centers consisted of using the meteorological, environmental and human intervention variables to built groups of population centers with homogeneous characteristics. For this purpose, we tested two approaches. The first one consisted of performing an Agglomerative (\"bottom-up\") Hierarchical Clustering (AHC) analysis using different distances, linkage methods, and number of clusters selection methods. On the second one, we used Principal Component Analysis (PCA) to reduce the dimension of the variables to one principal dimension and used it's scores to create groups by quantile classification.\n\n### Agglomerative hierarchical clustering analysis\n\nThe AHC analysis consisted of two steps. First, we run several configurations the agglomerative nesting algorithms and selected the one which gave us the best hierarchical clustering (HC) structure. Secondly, from the selected hierarchical clustering structure, we calculated and examined a number of indices for determining the most appropriate number of clusters.\n\n#### Chosing the hierarchical clustering structure\n\nFor this first step, we tested combinations of the following methods:\n\n-   Scaling method: Whether to use normalization (scaling from 0 to 1) or standardadization (subtracting the mean and dividing by the standard deviation).\n-   Distance: Whether to use euclidean distance or correlation-based distances, such as Pearson or Spearman correlation.\n-   Linkage method: Whether to use average, single, complete, Ward or weighted average linkage method.\n\nFor each combination, we run the agglomerative nesting algorithm and calculated the *agglomerative coefficient* (AC) which is a measure of the strength of the HC structure [@boehmke2019hands, pp. 421-422]. For the 3 combinations of methods with larger AC, we also examined the resulting dendograms.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Select variables for analysis\nvariables = select(dataset, malaria:malaria_diff)\n\n# Function to scale data either by standardization or normalization\nscale_data = function(data, method = \"standardization\") {\n  if (method == \"standardization\") {\n    data_scaled = mutate(data, across(everything(), ~as.numeric(scale(.x))))\n  } \n  if (method == \"normalization\") {\n    data_scaled = mutate(data, across(everything(), scales::rescale))\n  }\n  data_scaled\n}\n\n# Listing the configurations for the scaling, distance and linkage methods\nscaling_method = c(\"standardization\", \"normalization\")\ndist_method = c(\"euclidean\", \"pearson\", \"spearman\")\nlinkage_method = c(\"average\", \"single\", \"complete\", \"ward\", \"weighted\")\n\n# Table with all the combinations\ndesign = tidyr::expand_grid(scaling_method, dist_method, linkage_method, variables)\n\n# Calculate the agglomerative coefficient for each combination\nagglomerative_coeff = design %>% \n  tidyr::nest(data = -c(scaling_method, dist_method, linkage_method)) %>% \n  mutate(\n    scaling = purrr::map2(data, scaling_method, ~scale_data(.x, method = .y)),\n    dist_mat = purrr::map2(scaling, dist_method, ~get_dist(.x, method = .y)),\n    tree = purrr::map2(dist_mat, linkage_method, ~agnes(.x, method = .y)),\n    ac = purrr::map(tree, ~.x$ac)\n  ) %>% \n  tidyr::unnest(ac) %>% \n  arrange(-ac)\n```\n:::\n\n\nThe best 3 HC structures according to the AC were the following:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Display the best 3 structures \nagglomerative_coeff %>% \n  slice_head(n = 3) %>% \n  select(-c(data, scaling, dist_mat, tree)) %>% \n  mutate(across(where(is.character), stringr::str_to_title)) %>% \n  mutate(across(where(is.numeric), ~round(.x, 4))) %>% \n  DT::datatable(\n    colnames = c(\"Scaling\", \"Distance\", \"Linkage\", \"AC\"),\n    options = list(dom = 't')\n  )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-77ae4e2f3c313a0fafc1\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-77ae4e2f3c313a0fafc1\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\"],[\"Standardization\",\"Normalization\",\"Standardization\"],[\"Pearson\",\"Pearson\",\"Spearman\"],[\"Ward\",\"Ward\",\"Ward\"],[0.8319,0.8176,0.8024]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Scaling<\\/th>\\n      <th>Distance<\\/th>\\n      <th>Linkage<\\/th>\\n      <th>AC<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"dom\":\"t\",\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":4},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n<br>\n\nThe difference of the AC values are almost negligible. Consequently, we examined the dendograms:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function to plot a dendogram\ndendogram = function(row, title) {\n  dendogram <- fviz_dend(agglomerative_coeff$tree[[row]], main = title) + \n    theme(text = element_text(size = 18))\n  \n  dendogram\n}\n```\n:::\n\n\n::: panel-tabset\n##### HC structure 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndendogram(1, \"Standardization, Spearman correlation, Ward linkage\")\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n##### HC structure 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndendogram(2, \"Normalization, Pearson correlation, Ward linkage\")\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n##### HC structure 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndendogram(3, \"Standardization, Pearson correlation, Ward linkage\")\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n:::\n\nAfter inspecting the dendrograms, we chose the first HC structure as it seemed to form more homogeneous groups with relatively similar sizes for the different height values.\n\n### Determining the number of clusters\n\nWe calculated and plotted the average silhouette width, total within sum of squares and gap statistic for a range of 1 to 10 number of clusters and examined the optimal number of cluster for each criteria. We defined a range of numbers of clusters that met or near met the optimal criteria and then for each one of them we used PCA to visualize the clusters in 2 dimensions to evaluate how well the groups were formed. In addition, the individual silhouette index of each observation was calculated and plotted to assess if there were observations that might have been misclustered.\n\n#### Evaluation of the criteria of the optimal number of clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function to plot optimal number of clusters plot for a certain criteria\nnbclust_plot = function(data, method, ...) {\n  nbclust <- fviz_nbclust(\n    data, hcut, hc_func = \"agnes\", hc_method = \"ward.D2\", \n    c_metric = \"spearman\", method = method, ...\n  ) + theme(text = element_text(size = 18))\n  \n  nbclust\n}\n\n# Scale variables using standardization\nvariables_std = mutate(variables, across(everything(), ~as.numeric(scale(.x))))\n```\n:::\n\n\n::: panel-tabset\n##### Average silhouette width\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2022)\nnbclust_plot(variables_std, \"silhouette\")\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n##### Total within sum of squares\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnbclust_plot(variables_std, \"wss\")\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n##### Gap statistic\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2022)\nnbclust_plot(variables_std, \"gap_stat\", verbose = FALSE)\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n:::\n\nFrom these plots, we determined that the optimal number of cluster may be between 2 and 4 clusters.\n\n#### Clusters plots {#clusters-plots}\n\nNext, we plotted the clusters in a plane using PCA for 2, 3 and 4 clusters.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function to cut tree\ncut_tree = function(data, k) {\n  tree = hcut(\n    data, k = k, hc_func = \"agnes\", hc_method = \"ward.D2\", \n    hc_metric = \"spearman\"\n  )\n  tree\n}\n\n# Function to generate cluster plot\ncluster_plot = function(tree) {\n  cluster = fviz_cluster(tree, ggtheme = theme_classic()) +\n    geom_vline(xintercept = 0, linetype = \"dashed\") +\n    geom_hline(yintercept = 0, linetype = \"dashed\") +\n    theme(text = element_text(size = 18))\n  \n  cluster\n}\n```\n:::\n\n\n::: panel-tabset\n##### 2 clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntree_2 = cut_tree(variables_std, 2)\ncluster_plot(tree_2)\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n##### 3 clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntree_3 = cut_tree(variables_std, 3)\ncluster_plot(tree_3)\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n##### 4 clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntree_4 = cut_tree(variables_std, 4)\ncluster_plot(tree_4)\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n:::\n\nIn the case of 2 clusters, the groups seem to be defined according to whether the scores of the observations on the first dimension are positive or negative. In the case of 3 clusters, the group with negative scores on the first dimension is divided if the scores on the second dimension are positive and negative. Finally, in the case of 4 clusters, the groups seem to be defined according to their belonging to one of the 4 quadrants.\n\n#### Individual silhouette widths\n\nNext, we plotted the individual silhouette width for the observations grouped in 2, 3 and 4 clusters.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function to plot individual silhouette widths\nsilhouette_plot = function(tree) {\n  ind_silhouette <- tree %>%\n    fviz_silhouette(ggtheme = theme_classic(), print.summary = FALSE) +\n    theme(text = element_text(size = 18))\n  \n  ind_silhouette\n}\n```\n:::\n\n\n::: panel-tabset\n##### 2 clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsilhouette_plot(tree_2)\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n##### 3 clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsilhouette_plot(tree_3)\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n##### 4 clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsilhouette_plot(tree_4)\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n:::\n\nWe see that with 2 clusters we obtain a greater average silhouette width (0.49), followed by 4 clusters (0.44) and lastly the case with 3 clusters (0.43). The least number of observations possibly misclustered is obtained with 3 clusters (2), followed by 2 clusters (3), and lastly the case with 4 clusters (5).\n\n#### HC groups on maps\n\nAs an additional step, for a number of clusters of 2, 3 and 4, we plotted the population centers (polygon centroids) on a map coloured by group to see their spatial distribution.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create table with the groups\ndataset_clustering = dataset %>% \n  mutate(\n    hc_group_2 = as.factor(tree_2$cluster),\n    hc_group_3 = as.factor(tree_3$cluster),\n    hc_group_4 = as.factor(tree_4$cluster)\n  )\n\n# Function to plot a map with the clusters\ncluster_map = function(data, palette, group_var) {\n  values = pull(data, {{group_var}})\n  \n  map = dataset_clustering %>% \n    sf::st_as_sf(coords = c(\"lon\", \"lat\"), crs = 4326) %>%\n    leaflet() %>% \n    addTiles(group = \"OpenStreetMap\") %>% \n    addProviderTiles(provider = providers$CartoDB, group = \"CartoDB\") %>%\n    addProviderTiles(provider = providers$Esri.WorldImagery, group = \"Satelital\") %>% \n    addCircleMarkers(\n      popup = dataset$population_center, color = ~palette(values),\n      opacity = 1, radius = 0.1, fillOpacity = 0.5\n    )%>%\n    addLayersControl(baseGroups = c(\"CartoDB\", \"OpenStreetMap\", \"Satelital\")) %>%\n    addLegend(\n      title = \"Cluster\", pal = palette, values = values, opacity = 1,\n      position = \"bottomright\"\n      )\n  map\n}\n```\n:::\n\n\n::: panel-tabset\n##### 2 clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Palette for 2 clusters\npalette_hc_2 = colorFactor(\n  palette = \"viridis\", domain = dataset_clustering$hc_group_2\n)\n\n# Plot cluster map\ncluster_map(dataset_clustering, palette_hc_2, hc_group_2)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"leaflet html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-674a1e097bf71e521327\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-674a1e097bf71e521327\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,\"OpenStreetMap\",{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org\\\">OpenStreetMap<\\/a> contributors, <a href=\\\"https://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA<\\/a>\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB\",null,\"CartoDB\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addProviderTiles\",\"args\":[\"Esri.WorldImagery\",null,\"Satelital\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addCircleMarkers\",\"args\":[[-3.82858322599998,-3.88769027499995,-4.00329833399996,-3.95913039899995,-3.93173572399996,-4.02110999999996,-4.06482666699998,-4.12184414699993,-4.16213717299996,-4.35699666699998,-4.12628744999995],[-73.3549727779999,-73.351416802,-73.39309,-73.345052094,-73.391568174,-73.423671667,-73.47498,-73.483562489,-73.490329634,-73.55276,-73.497835315],0.1,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":[\"#440154\",\"#440154\",\"#440154\",\"#440154\",\"#440154\",\"#440154\",\"#440154\",\"#FDE725\",\"#FDE725\",\"#FDE725\",\"#FDE725\"],\"weight\":5,\"opacity\":1,\"fill\":true,\"fillColor\":[\"#440154\",\"#440154\",\"#440154\",\"#440154\",\"#440154\",\"#440154\",\"#440154\",\"#FDE725\",\"#FDE725\",\"#FDE725\",\"#FDE725\"],\"fillOpacity\":0.5},null,null,[\"ZUNGARO COCHA\",\"VARILLAL\",\"5 DE JUNIO\",\"SAN CARLOS\",\"SAN JOSE\",\"24 DE JUNIO\",\"EX PETROLEROS II ZONA\",\"SANTA CATALINA\",\"HUAMBE\",\"1 DE FEBRERO\",\"NUEVO TRIUNFO\"],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLayersControl\",\"args\":[[\"CartoDB\",\"OpenStreetMap\",\"Satelital\"],[],{\"collapsed\":true,\"autoZIndex\":true,\"position\":\"topright\"}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154\",\"#FDE725\"],\"labels\":[\"1\",\"2\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":1,\"position\":\"bottomright\",\"type\":\"factor\",\"title\":\"Cluster\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[-4.35699666699998,-3.82858322599998],\"lng\":[-73.55276,-73.345052094]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n##### 3 clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Palette for 3 clusters\npalette_hc_3 = colorFactor(\n  palette = \"viridis\", domain = dataset_clustering$hc_group_3\n)\n\n# Plot cluster map\ncluster_map(dataset_clustering, palette_hc_3, hc_group_3)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"leaflet html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-4cefc08f2941de9b022f\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-4cefc08f2941de9b022f\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,\"OpenStreetMap\",{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org\\\">OpenStreetMap<\\/a> contributors, <a href=\\\"https://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA<\\/a>\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB\",null,\"CartoDB\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addProviderTiles\",\"args\":[\"Esri.WorldImagery\",null,\"Satelital\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addCircleMarkers\",\"args\":[[-3.82858322599998,-3.88769027499995,-4.00329833399996,-3.95913039899995,-3.93173572399996,-4.02110999999996,-4.06482666699998,-4.12184414699993,-4.16213717299996,-4.35699666699998,-4.12628744999995],[-73.3549727779999,-73.351416802,-73.39309,-73.345052094,-73.391568174,-73.423671667,-73.47498,-73.483562489,-73.490329634,-73.55276,-73.497835315],0.1,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":[\"#440154\",\"#440154\",\"#21908D\",\"#440154\",\"#440154\",\"#21908D\",\"#21908D\",\"#FDE725\",\"#FDE725\",\"#FDE725\",\"#FDE725\"],\"weight\":5,\"opacity\":1,\"fill\":true,\"fillColor\":[\"#440154\",\"#440154\",\"#21908D\",\"#440154\",\"#440154\",\"#21908D\",\"#21908D\",\"#FDE725\",\"#FDE725\",\"#FDE725\",\"#FDE725\"],\"fillOpacity\":0.5},null,null,[\"ZUNGARO COCHA\",\"VARILLAL\",\"5 DE JUNIO\",\"SAN CARLOS\",\"SAN JOSE\",\"24 DE JUNIO\",\"EX PETROLEROS II ZONA\",\"SANTA CATALINA\",\"HUAMBE\",\"1 DE FEBRERO\",\"NUEVO TRIUNFO\"],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLayersControl\",\"args\":[[\"CartoDB\",\"OpenStreetMap\",\"Satelital\"],[],{\"collapsed\":true,\"autoZIndex\":true,\"position\":\"topright\"}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154\",\"#21908D\",\"#FDE725\"],\"labels\":[\"1\",\"2\",\"3\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":1,\"position\":\"bottomright\",\"type\":\"factor\",\"title\":\"Cluster\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[-4.35699666699998,-3.82858322599998],\"lng\":[-73.55276,-73.345052094]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n##### 4 clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Palette for 4 clusters\npalette_hc_4 = colorFactor(\n  palette = \"viridis\", domain = dataset_clustering$hc_group_4\n)\n\n# Plot cluster map\ncluster_map(dataset_clustering, palette_hc_4, hc_group_4)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"leaflet html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-dcb56bfd6462e616b5af\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-dcb56bfd6462e616b5af\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,\"OpenStreetMap\",{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org\\\">OpenStreetMap<\\/a> contributors, <a href=\\\"https://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA<\\/a>\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB\",null,\"CartoDB\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addProviderTiles\",\"args\":[\"Esri.WorldImagery\",null,\"Satelital\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addCircleMarkers\",\"args\":[[-3.82858322599998,-3.88769027499995,-4.00329833399996,-3.95913039899995,-3.93173572399996,-4.02110999999996,-4.06482666699998,-4.12184414699993,-4.16213717299996,-4.35699666699998,-4.12628744999995],[-73.3549727779999,-73.351416802,-73.39309,-73.345052094,-73.391568174,-73.423671667,-73.47498,-73.483562489,-73.490329634,-73.55276,-73.497835315],0.1,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":[\"#440154\",\"#440154\",\"#31688E\",\"#35B779\",\"#35B779\",\"#31688E\",\"#31688E\",\"#FDE725\",\"#FDE725\",\"#FDE725\",\"#FDE725\"],\"weight\":5,\"opacity\":1,\"fill\":true,\"fillColor\":[\"#440154\",\"#440154\",\"#31688E\",\"#35B779\",\"#35B779\",\"#31688E\",\"#31688E\",\"#FDE725\",\"#FDE725\",\"#FDE725\",\"#FDE725\"],\"fillOpacity\":0.5},null,null,[\"ZUNGARO COCHA\",\"VARILLAL\",\"5 DE JUNIO\",\"SAN CARLOS\",\"SAN JOSE\",\"24 DE JUNIO\",\"EX PETROLEROS II ZONA\",\"SANTA CATALINA\",\"HUAMBE\",\"1 DE FEBRERO\",\"NUEVO TRIUNFO\"],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLayersControl\",\"args\":[[\"CartoDB\",\"OpenStreetMap\",\"Satelital\"],[],{\"collapsed\":true,\"autoZIndex\":true,\"position\":\"topright\"}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154\",\"#31688E\",\"#35B779\",\"#FDE725\"],\"labels\":[\"1\",\"2\",\"3\",\"4\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":1,\"position\":\"bottomright\",\"type\":\"factor\",\"title\":\"Cluster\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[-4.35699666699998,-3.82858322599998],\"lng\":[-73.55276,-73.345052094]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n:::\n\nWe see that the groups seem to divide longitudinally, showing a strong spatial component driving the separation between them.\n\n### Principal components analysis\n\nPrincipal component analysis (PCA) was used as an alternative method for clustering. Our approach was to use the principal component to build an aggregate index of all the variables considered. Then, the scores of the populated centers on this principal component were grouped into different categories according to the quantiles of the distribution. In order to compare this approach with the results of hierarchical clustering, we tested with 2 (50th quantile), 3 (33th and 66th quantiles) and 4 (25th, 50th and 75th quantiles) groups.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Perform PCA\npca = FactoMineR::PCA(variables_std, graph = FALSE)\n```\n:::\n\n\n#### Scree plot\n\nAfter having performed the PCA, we plotted the scree plot to check the percentage of explained variance each component or dimension.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npca %>% \n  fviz_screeplot() +\n  theme(text = element_text(size = 18))\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\nWe see that the first component explain approximately 50% of the variance in the data. This is not such a high value, meaning that the variables do not seem to be strongly linearly correlated. Still, 50% is an acceptable value in practice.\n\n#### Contribution plot\n\nNext, we plotted the top 10 variables according to their contribution to the first component.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npca %>% \n  fviz_contrib(choice = \"var\", axes = 1, top = 10) +\n  theme(text = element_text(size = 18))\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\nWe see that the soil moisture, precipitation and runoff variables are the ones that contribute the most to explaining the first component.\n\n#### Coordinate plane\n\nNow, we plotted the population centers on a coordinate plane using the first and second components.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npca %>% \n  fviz_pca_ind() +\n  theme(text = element_text(size = 18))\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\nAs in the \\@ref(clusters-plots), we see that the variability of the points is distributed mostly over the first component (X axis).\n\n#### PCA groups on maps\n\nFinally, we created the groups dividing the population centers according to the quantiles of the scores on the principal component. Then we plotted the population centers on maps for 2, 3 and 4 groups.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get scores\npca_results = get_pca_ind(pca)\nscores = pca_results$coord\n\n# Create groups by quantile categorization\ndataset_strata = dataset_clustering %>% \n  mutate(pca_score = scores[, 1]) %>% \n  mutate(\n    pca_group_2 = cut(\n      pca_score, breaks = quantile(pca_score, c(0, .5, 1)), \n      labels = as.character(rev(1:2)),\n      include.lowest = TRUE\n    ),\n    pca_group_3 = cut(\n      pca_score, breaks = quantile(pca_score, c(0, .33, .66, 1)), \n      labels = as.character(rev(1:3)),\n      include.lowest = TRUE\n    ),\n    pca_group_4 = cut(\n      pca_score, breaks = quantile(pca_score, c(0, .25, .5, .75, 1)), \n      labels = as.character(rev(1:4)),\n      include.lowest = TRUE\n    )\n  ) %>% \n  mutate(across(pca_group_2:pca_group_4, forcats::fct_rev))\n```\n:::\n\n\n::: panel-tabset\n##### 2 groups\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Palette for 2 groups\npalette_pca_2 = colorFactor(\n  palette = \"viridis\", domain = dataset_strata$pca_group_2\n)\n\n# Plot cluster map\ncluster_map(dataset_strata, palette_pca_2, pca_group_2)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"leaflet html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-d92d620207553cb9d3f0\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-d92d620207553cb9d3f0\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,\"OpenStreetMap\",{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org\\\">OpenStreetMap<\\/a> contributors, <a href=\\\"https://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA<\\/a>\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB\",null,\"CartoDB\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addProviderTiles\",\"args\":[\"Esri.WorldImagery\",null,\"Satelital\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addCircleMarkers\",\"args\":[[-3.82858322599998,-3.88769027499995,-4.00329833399996,-3.95913039899995,-3.93173572399996,-4.02110999999996,-4.06482666699998,-4.12184414699993,-4.16213717299996,-4.35699666699998,-4.12628744999995],[-73.3549727779999,-73.351416802,-73.39309,-73.345052094,-73.391568174,-73.423671667,-73.47498,-73.483562489,-73.490329634,-73.55276,-73.497835315],0.1,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":[\"#440154\",\"#440154\",\"#440154\",\"#440154\",\"#440154\",\"#FDE725\",\"#FDE725\",\"#FDE725\",\"#FDE725\",\"#FDE725\",\"#FDE725\"],\"weight\":5,\"opacity\":1,\"fill\":true,\"fillColor\":[\"#440154\",\"#440154\",\"#440154\",\"#440154\",\"#440154\",\"#FDE725\",\"#FDE725\",\"#FDE725\",\"#FDE725\",\"#FDE725\",\"#FDE725\"],\"fillOpacity\":0.5},null,null,[\"ZUNGARO COCHA\",\"VARILLAL\",\"5 DE JUNIO\",\"SAN CARLOS\",\"SAN JOSE\",\"24 DE JUNIO\",\"EX PETROLEROS II ZONA\",\"SANTA CATALINA\",\"HUAMBE\",\"1 DE FEBRERO\",\"NUEVO TRIUNFO\"],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLayersControl\",\"args\":[[\"CartoDB\",\"OpenStreetMap\",\"Satelital\"],[],{\"collapsed\":true,\"autoZIndex\":true,\"position\":\"topright\"}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154\",\"#FDE725\"],\"labels\":[\"1\",\"2\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":1,\"position\":\"bottomright\",\"type\":\"factor\",\"title\":\"Cluster\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[-4.35699666699998,-3.82858322599998],\"lng\":[-73.55276,-73.345052094]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n##### 3 groups\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Palette for 3 groups\npalette_pca_3 = colorFactor(\n  palette = \"viridis\", domain = dataset_strata$pca_group_3\n)\n\n# Plot cluster map\ncluster_map(dataset_strata, palette_pca_3, pca_group_3)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"leaflet html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-138a4fd8f6a1683c1b49\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-138a4fd8f6a1683c1b49\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,\"OpenStreetMap\",{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org\\\">OpenStreetMap<\\/a> contributors, <a href=\\\"https://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA<\\/a>\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB\",null,\"CartoDB\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addProviderTiles\",\"args\":[\"Esri.WorldImagery\",null,\"Satelital\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addCircleMarkers\",\"args\":[[-3.82858322599998,-3.88769027499995,-4.00329833399996,-3.95913039899995,-3.93173572399996,-4.02110999999996,-4.06482666699998,-4.12184414699993,-4.16213717299996,-4.35699666699998,-4.12628744999995],[-73.3549727779999,-73.351416802,-73.39309,-73.345052094,-73.391568174,-73.423671667,-73.47498,-73.483562489,-73.490329634,-73.55276,-73.497835315],0.1,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":[\"#440154\",\"#440154\",\"#21908D\",\"#440154\",\"#440154\",\"#21908D\",\"#21908D\",\"#FDE725\",\"#FDE725\",\"#FDE725\",\"#FDE725\"],\"weight\":5,\"opacity\":1,\"fill\":true,\"fillColor\":[\"#440154\",\"#440154\",\"#21908D\",\"#440154\",\"#440154\",\"#21908D\",\"#21908D\",\"#FDE725\",\"#FDE725\",\"#FDE725\",\"#FDE725\"],\"fillOpacity\":0.5},null,null,[\"ZUNGARO COCHA\",\"VARILLAL\",\"5 DE JUNIO\",\"SAN CARLOS\",\"SAN JOSE\",\"24 DE JUNIO\",\"EX PETROLEROS II ZONA\",\"SANTA CATALINA\",\"HUAMBE\",\"1 DE FEBRERO\",\"NUEVO TRIUNFO\"],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLayersControl\",\"args\":[[\"CartoDB\",\"OpenStreetMap\",\"Satelital\"],[],{\"collapsed\":true,\"autoZIndex\":true,\"position\":\"topright\"}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154\",\"#21908D\",\"#FDE725\"],\"labels\":[\"1\",\"2\",\"3\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":1,\"position\":\"bottomright\",\"type\":\"factor\",\"title\":\"Cluster\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[-4.35699666699998,-3.82858322599998],\"lng\":[-73.55276,-73.345052094]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n##### 4 groups\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Palette for 4 groups\npalette_pca_4 = colorFactor(\n  palette = \"viridis\", domain = dataset_strata$pca_group_4\n)\n\n# Plot cluster map\ncluster_map(dataset_strata, palette_pca_4, pca_group_4)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"leaflet html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-bd916f25d778e2df7f19\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-bd916f25d778e2df7f19\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,\"OpenStreetMap\",{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org\\\">OpenStreetMap<\\/a> contributors, <a href=\\\"https://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA<\\/a>\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB\",null,\"CartoDB\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addProviderTiles\",\"args\":[\"Esri.WorldImagery\",null,\"Satelital\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addCircleMarkers\",\"args\":[[-3.82858322599998,-3.88769027499995,-4.00329833399996,-3.95913039899995,-3.93173572399996,-4.02110999999996,-4.06482666699998,-4.12184414699993,-4.16213717299996,-4.35699666699998,-4.12628744999995],[-73.3549727779999,-73.351416802,-73.39309,-73.345052094,-73.391568174,-73.423671667,-73.47498,-73.483562489,-73.490329634,-73.55276,-73.497835315],0.1,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":[\"#440154\",\"#440154\",\"#31688E\",\"#31688E\",\"#440154\",\"#35B779\",\"#35B779\",\"#35B779\",\"#FDE725\",\"#FDE725\",\"#FDE725\"],\"weight\":5,\"opacity\":1,\"fill\":true,\"fillColor\":[\"#440154\",\"#440154\",\"#31688E\",\"#31688E\",\"#440154\",\"#35B779\",\"#35B779\",\"#35B779\",\"#FDE725\",\"#FDE725\",\"#FDE725\"],\"fillOpacity\":0.5},null,null,[\"ZUNGARO COCHA\",\"VARILLAL\",\"5 DE JUNIO\",\"SAN CARLOS\",\"SAN JOSE\",\"24 DE JUNIO\",\"EX PETROLEROS II ZONA\",\"SANTA CATALINA\",\"HUAMBE\",\"1 DE FEBRERO\",\"NUEVO TRIUNFO\"],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLayersControl\",\"args\":[[\"CartoDB\",\"OpenStreetMap\",\"Satelital\"],[],{\"collapsed\":true,\"autoZIndex\":true,\"position\":\"topright\"}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#440154\",\"#31688E\",\"#35B779\",\"#FDE725\"],\"labels\":[\"1\",\"2\",\"3\",\"4\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":1,\"position\":\"bottomright\",\"type\":\"factor\",\"title\":\"Cluster\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[-4.35699666699998,-3.82858322599998],\"lng\":[-73.55276,-73.345052094]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n:::\n\nGeographically, the PCA groups seem to be distributed very similarly with the HC groups.\n\n### Comparing HC and PCA\n\nWe assessed how strong was the agreement between the HC method and PCA method on the grouping of the population centers, for 2, 3 and 4 groups. Confusion matrices and the Kappa statistic were used for this analysis.\n\n#### Confusion matrices\n\n::: panel-tabset\n##### 2 groups\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset_strata %>% \n  yardstick::conf_mat(hc_group_2, pca_group_2, dnn = c(\"PCA\", \"HC\")) %>% \n  autoplot(type = \"heatmap\") +\n  theme(text = element_text(size = 18))\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n\n##### 3 groups\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset_strata %>% \n  yardstick::conf_mat(hc_group_3, pca_group_3, dnn = c(\"PCA\", \"HC\")) %>% \n  autoplot(type = \"heatmap\") +\n  theme(text = element_text(size = 18))\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n\n##### 4 groups\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset_strata %>% \n  yardstick::conf_mat(hc_group_4, pca_group_4, dnn = c(\"PCA\", \"HC\")) %>% \n  autoplot(type = \"heatmap\") +\n  theme(text = element_text(size = 18))\n```\n\n::: {.cell-output-display}\n![](methodology_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get kappa statistic\nkap_2 = yardstick::kap(dataset_strata, hc_group_2, pca_group_2)\nkap_3 = yardstick::kap(dataset_strata, hc_group_3, pca_group_3)\nkap_4 = yardstick::kap(dataset_strata, hc_group_4, pca_group_4)\n```\n:::\n\n\nFrom the confusion matrices it is evident a strong agreement between the HC method and the PCA method.The agreement is stronger in the case of 2 clusters (kappa = 0.65), followed by the case of 3 clusters (kappa = 1) and lastly the case of 4 clusters (kappa = 0.4).\n\nFinally, we opted to work with 4 clusters because this number gives us a greater spatial heterogeneity of populated centers.\n\n## Sampling\n\nHaving chosen the number of clusters, we draw a random sample from each of them proportional to their size to obtain a sample size of no less than 10 or 20 population centers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Sample 20 population centers\nset.seed(2022)\nsampling_20 = dataset_strata %>% \n  group_by(hc_group_4) %>% \n  slice_sample(prop = 0.43) %>% \n  ungroup()\n\n# Sample 10 population centers\nset.seed(2022)\nsampling_10 = dataset_strata %>% \n  group_by(hc_group_4) %>% \n  slice_sample(prop = 0.23) %>% \n  ungroup()\n```\n:::\n\n::: {.cell}\n\n:::\n\n\nNext, we plot the samples in a map to see their geographical distribution.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Coordinates of the full dataset\nfull_dataset = dataset_strata %>% \n  sf::st_as_sf(coords = c(\"lon\", \"lat\"))\n\n# Coordinates of the 10 samples\nsample_10_dataset = sampling_10 %>% \n  sf::st_as_sf(coords = c(\"lon\", \"lat\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in min(cc[[1]], na.rm = TRUE): ning√∫n argumento finito para min;\nretornando Inf\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in min(cc[[2]], na.rm = TRUE): ning√∫n argumento finito para min;\nretornando Inf\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in max(cc[[1]], na.rm = TRUE): ningun argumento finito para max;\nretornando -Inf\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in max(cc[[2]], na.rm = TRUE): ningun argumento finito para max;\nretornando -Inf\n```\n:::\n\n```{.r .cell-code}\n# Coordinates of the 20 samples\nsample_20_dataset = sampling_20 %>% \n  sf::st_as_sf(coords = c(\"lon\", \"lat\"))\n\n# Function to plot the samples on a map\nsample_map = function(data, palette, group_var) {\n  values = pull(data, {{group_var}})\n  map = data %>% \n    leaflet() %>% \n    addTiles(group = \"OpenStreetMap\") %>% \n    addProviderTiles(provider = providers$CartoDB,group = \"CartoDB\") %>%\n    addProviderTiles(provider = providers$Esri.WorldImagery,group = \"Satelital\") %>%\n    addCircleMarkers(\n      data = full_dataset, opacity = 1, radius = 0.1, fillOpacity = 0.5, \n      color = \"lightgray\"\n      ) %>% \n    addCircleMarkers(\n      popup = data$population_center, color = ~palette(values),\n      opacity = 1, radius = 0.1, fillOpacity = 0.5\n      )%>% \n    addLayersControl(baseGroups = c(\"CartoDB\",\"OpenStreetMap\", \"Satelital\")) %>% \n    addLegend(\n      title = \"Cluster\", pal = palette, values = values, opacity = 1,\n      position = \"bottomright\"\n    )\n  map\n}\n```\n:::\n\n\n::: panel-tabset\n### 10 samples\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Palette for 10 samples\npalette_10 = colorFactor(\n  palette = \"viridis\", domain = sample_10_dataset$hc_group_4\n)\n\n# Map the 10 samples\nsample_map(sample_10_dataset, palette_10, hc_group_4)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"leaflet html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-4ed06f4991b3aa9d48ec\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-4ed06f4991b3aa9d48ec\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,\"OpenStreetMap\",{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org\\\">OpenStreetMap<\\/a> contributors, <a href=\\\"https://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA<\\/a>\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB\",null,\"CartoDB\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addProviderTiles\",\"args\":[\"Esri.WorldImagery\",null,\"Satelital\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addCircleMarkers\",\"args\":[[-3.82858322599998,-3.88769027499995,-4.00329833399996,-3.95913039899995,-3.93173572399996,-4.02110999999996,-4.06482666699998,-4.12184414699993,-4.16213717299996,-4.35699666699998,-4.12628744999995],[-73.3549727779999,-73.351416802,-73.39309,-73.345052094,-73.391568174,-73.423671667,-73.47498,-73.483562489,-73.490329634,-73.55276,-73.497835315],0.1,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":\"lightgray\",\"weight\":5,\"opacity\":1,\"fill\":true,\"fillColor\":\"lightgray\",\"fillOpacity\":0.5},null,null,null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addCircleMarkers\",\"args\":[[],[],0.1,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":[],\"weight\":5,\"opacity\":1,\"fill\":true,\"fillColor\":[],\"fillOpacity\":0.5},null,null,[],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLayersControl\",\"args\":[[\"CartoDB\",\"OpenStreetMap\",\"Satelital\"],[],{\"collapsed\":true,\"autoZIndex\":true,\"position\":\"topright\"}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[],\"labels\":[\"\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":1,\"position\":\"bottomright\",\"type\":\"factor\",\"title\":\"Cluster\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[-4.35699666699998,-3.82858322599998],\"lng\":[-73.55276,-73.345052094]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### 20 samples\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Palette for 20 samples\npalette_20 = colorFactor(\n  palette = \"viridis\", domain = sample_20_dataset$hc_group_4\n)\n\n# Map the 20 samples\nsample_map(sample_20_dataset, palette_20, hc_group_4)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"leaflet html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-c3016ebda52612636f4a\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c3016ebda52612636f4a\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,\"OpenStreetMap\",{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org\\\">OpenStreetMap<\\/a> contributors, <a href=\\\"https://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA<\\/a>\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB\",null,\"CartoDB\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addProviderTiles\",\"args\":[\"Esri.WorldImagery\",null,\"Satelital\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addCircleMarkers\",\"args\":[[-3.82858322599998,-3.88769027499995,-4.00329833399996,-3.95913039899995,-3.93173572399996,-4.02110999999996,-4.06482666699998,-4.12184414699993,-4.16213717299996,-4.35699666699998,-4.12628744999995],[-73.3549727779999,-73.351416802,-73.39309,-73.345052094,-73.391568174,-73.423671667,-73.47498,-73.483562489,-73.490329634,-73.55276,-73.497835315],0.1,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":\"lightgray\",\"weight\":5,\"opacity\":1,\"fill\":true,\"fillColor\":\"lightgray\",\"fillOpacity\":0.5},null,null,null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addCircleMarkers\",\"args\":[[-4.06482666699998,-4.16213717299996],[-73.47498,-73.490329634],0.1,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":[\"#31688E\",\"#FDE725\"],\"weight\":5,\"opacity\":1,\"fill\":true,\"fillColor\":[\"#31688E\",\"#FDE725\"],\"fillOpacity\":0.5},null,null,[\"EX PETROLEROS II ZONA\",\"HUAMBE\"],null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLayersControl\",\"args\":[[\"CartoDB\",\"OpenStreetMap\",\"Satelital\"],[],{\"collapsed\":true,\"autoZIndex\":true,\"position\":\"topright\"}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#31688E\",\"#FDE725\"],\"labels\":[\"2\",\"4\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":1,\"position\":\"bottomright\",\"type\":\"factor\",\"title\":\"Cluster\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":null}]}],\"limits\":{\"lat\":[-4.35699666699998,-3.82858322599998],\"lng\":[-73.55276,-73.345052094]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n:::\n",
    "supporting": [
      "methodology_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/htmlwidgets-1.6.1/htmlwidgets.js\"></script>\r\n<link href=\"site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/datatables-binding-0.26/datatables.js\"></script>\r\n<script src=\"site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\r\n<link href=\"site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\r\n<link href=\"site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js\"></script>\r\n<link href=\"site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\r\n<link href=\"site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/leaflet-1.3.1/leaflet.js\"></script>\r\n<link href=\"site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/proj4-2.6.2/proj4.min.js\"></script>\r\n<script src=\"site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\r\n<link href=\"site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/leaflet-binding-2.1.1/leaflet.js\"></script>\r\n<script src=\"site_libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js\"></script>\r\n<script src=\"site_libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}